geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(Shape="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(Shape="Gene-count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(Genes="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(Genes="Gene-count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
data1
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
data1
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1
data1[,"Name"]=capitalize(data1[,"Name"])
data1
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,shape = 5,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape = 5)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape = 5)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape = 1)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
data1
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape = 1)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape =22)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape =15)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 500, height = 480, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape =15)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 550, height = 500, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape =15)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 550, height = 500, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue),shape =15)+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 550, height = 500, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#8B2323", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
colourpicker:::colourPickerAddin()
##################GO图
library(Cairo)
library(ggplot2)
library(Hmisc)
setwd("/Users/tongyuantao/Desktop/pplot/virus")
file=dir()
data1 <- read.table(file[1],header = T,sep = "\t")
data1[,"virus"]="AAV2"
data1=data1[which(data1$namespace=="biological_process" & data1$level!=1),]
data1=data1[1:5,]
for (va in file[2:length(file)]) {
data <- read.table(va,header = T,sep = "\t")
data=data[which(data$namespace=="biological_process" & data$level!=1),]
data[,"virus"]=gsub(".txt","",va)
data=data[1:5,]
data1=rbind(data1,data)
}
data1[,"Name"]=capitalize(data1[,"Name"])
###UP
Cairo(width = 550, height = 500, file="Circos.png", type="png", dpi='auto', bg = "transparent")
blues <- colorRampPalette(c("#E6514E", "#87CEFA","#B0E2FF"))(100)
p <- ggplot(data1, aes(x = virus,y =Name)) +
geom_point(aes(size=Genes,color=Pvalue))+
scale_colour_gradientn(colours =blues) +
theme_bw() +labs(size="Gene count", colour="Adj-Pvalue")
p <- p + labs(y="GO term",x="Virus name")
print (p)
dev.off()
